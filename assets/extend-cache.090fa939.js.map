{"version":3,"file":"extend-cache.090fa939.js","sources":["../../src/view/extend-cache.vue"],"sourcesContent":["<template>\n  <div class=\"default-content\">\n    <el-form :inline=\"true\">\n      <el-form-item label=\"readOnly：\">\n        <el-radio-group v-model=\"editable.config.readOnly\">\n          <el-radio :label=\"true\">true</el-radio>\n          <el-radio :label=\"false\">false</el-radio>\n        </el-radio-group>\n      </el-form-item>\n      <el-form-item label=\"defaultContent：\">\n        <el-select v-model=\"select\">\n          <template v-for=\"(article, index) in articles\" :key=\"article.title\">\n            <el-option :label=\"article.title\" :value=\"index\" />\n          </template>\n        </el-select>\n        <span v-if=\"editable.extendCache\">\n          切换前先\n          <span style=\"cursor: pointer; color: red\" @click=\"clearContent\">清除缓存</span>\n          <span v-show=\"editable.config.readOnly\" style=\"color: #cccccc; padding: 0 5px\">\n            （只读模式下，无法清除缓存）\n          </span>\n        </span>\n      </el-form-item>\n    </el-form>\n  </div>\n  <we-editor\n    toolbar-class=\"toolbar\"\n    editable-class=\"editable\"\n    :toolbar-option=\"toolbar\"\n    :editable-option=\"editable\"\n    v-model=\"formData.json\"\n    v-model:json=\"formData.jstr\"\n    v-model:html=\"formData.html\"\n  />\n  <br />\n  <el-card shadow=\"never\">\n    <el-button :disabled=\"modelType === 'json'\" @click=\"modelType = 'json'\">预览 JSON Array</el-button>\n    <el-button :disabled=\"modelType === 'jstr'\" @click=\"modelType = 'jstr'\">预览 JSON String</el-button>\n    <el-button :disabled=\"modelType === 'html'\" @click=\"modelType = 'html'\">预览 HTML String</el-button>\n  </el-card>\n  <br />\n  <u-prism style=\"--u-scroll-height: 300px\" :lang=\"modelType === 'html' ? 'html' : 'json'\" :content=\"preview\" />\n</template>\n\n<script lang=\"ts\">\n  import ARTICLES from '@assets/json/article.json'\n  import { useWangEditor } from 'wangeditor5-for-vue3'\n  import { computed, defineComponent, ref, shallowReactive, shallowRef, watch } from 'vue'\n  import UPrism from '../components/u-prism.vue'\n  import { useRoute } from 'vue-router'\n  import { SlateDescendant } from '@wangeditor/editor'\n\n  export default defineComponent({\n    components: { UPrism },\n    setup() {\n      const route = useRoute()\n      const articles = shallowRef(ARTICLES)\n\n      const { editable, toolbar, clearContent, reloadEditor } = useWangEditor(\n        {\n          defaultContent: articles.value[0].content,\n          config: {\n            placeholder: '请开始你的表演',\n            readOnly: false,\n          },\n          // 进行 v-model/v-model:json/v-model:html 绑定时，extendCache 选项无意义\n        },\n        null\n      )\n\n      const formData = shallowReactive({\n        json: [] as SlateDescendant[],\n        jstr: '',\n        html: '',\n      })\n\n      const modelType = ref<'json' | 'jstr' | 'html'>('json')\n\n      const preview = computed(() => {\n        switch (modelType.value) {\n          case 'json':\n            return JSON.stringify(formData.json, null, 2)\n          case 'jstr':\n            return formData.jstr\n          default:\n            return formData.html\n        }\n      })\n\n      const select = ref(0)\n\n      watch(select, (nv) => {\n        const content = articles.value[nv]?.content\n        if (content) {\n          editable.defaultContent = content\n          // 当编辑器有内容时，defaultContent 变化不会更新编辑器，这时我们需要强制重载编辑器\n          // 当进行了 v-model/v-model:json/v-model:html 绑定，且此时 editable.extendCache 为 true，那么即使重载编辑器默认内容依然以 v-model/v-model:json/v-model:html 为准\n          reloadEditor()\n        }\n      })\n\n      watch(\n        () => route.path,\n        (nv) => {\n          editable.extendCache = /true$/.test(nv)\n        },\n        { immediate: true }\n      )\n\n      return { articles, editable, toolbar, clearContent, formData, select, modelType, preview }\n    },\n  })\n</script>\n"],"names":["_createElementVNode","_createVNode","_withCtx","_openBlock","_createElementBlock","_Fragment","_renderList","_createBlock","_withDirectives","_vShow"],"mappings":"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"}